#!/usr/bin/env bash

set -eux

declare -r SESSION_PREFIX="sandbox"

declare RND="${RANDOM}"
declare SESSION="${SESSION_PREFIX}${RND}"

while tmux has-session -t "${SESSION}" 2>/dev/null
do
    RND="${RANDOM}"
    SESSION="${SESSION_PREFIX}${RND}"
done

readonly RND
readonly SESSION


declare WORKING_PROJECT
WORKING_PROJECT="$(mktemp -td "${SESSION_PREFIX}${RND}.XXXX")"
readonly WORKING_PROJECT

tmux new-session -s "${SESSION}" -d -c "${WORKING_PROJECT}"
tmux switch-client -t "${SESSION}"